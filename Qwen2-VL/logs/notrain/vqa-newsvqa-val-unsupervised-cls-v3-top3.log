+ CHECKPOINT=/gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
+ DATASET=vqa-newsvqa-val-unsupervised-cls-v3-top3
+ GPUS=8
+ CHECKPOINT=/gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
++ pwd
+ export PYTHONPATH=/mntnlp/zqp/physical_report/Qwen2-VL:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public
+ PYTHONPATH=/mntnlp/zqp/physical_report/Qwen2-VL:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public
+ echo 'CHECKPOINT: /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct'
CHECKPOINT: /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
+ MASTER_PORT=55810
+ PORT=62621
+ GPUS=8
+ export MASTER_PORT=55810
+ MASTER_PORT=55810
+ export PORT=62621
+ PORT=62621
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-mpdocvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v3-top3 ']'
+ torchrun --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --nproc_per_node=8 --master_port=55810 infer_mpdocvqa_dynamic_unsupervised_cls3.py --checkpoint /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct --max-pixels-low 200704 --max-pixels-high 802816 --datasets newsvqa_val --out-dir ./res/news-vqa --select-mode topk --select-image-num 3
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.34it/s]Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  3.82it/s]Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.10it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.92it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.22it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.72it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.18it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.66it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.79it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.79it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.77it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.73it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.34it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.16it/s]
Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.08it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.29it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  3.94it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.05it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.02it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.03it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.00it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.14it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.19it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.10it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.23it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.21it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.20it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.20it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.30it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.24it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.20it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.15it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.29it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.27it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.23it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.26it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.32it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.21it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.26it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.14it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.37it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.27it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.33it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.23it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.30it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.21it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.37it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.24it/s]
0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]1it [00:03,  3.42s/it]1it [00:03,  3.46s/it]1it [00:03,  3.31s/it]1it [00:03,  3.35s/it]1it [00:03,  3.39s/it]1it [00:03,  3.87s/it]1it [00:03,  3.37s/it]1it [00:03,  3.51s/it]2it [00:05,  2.61s/it]2it [00:05,  2.61s/it]2it [00:05,  2.57s/it]2it [00:05,  2.56s/it]2it [00:05,  2.57s/it]2it [00:05,  2.83s/it]2it [00:05,  2.60s/it]2it [00:05,  2.63s/it]3it [00:07,  2.34s/it]3it [00:07,  2.32s/it]3it [00:07,  2.43s/it]3it [00:07,  2.34s/it]3it [00:07,  2.38s/it]3it [00:07,  2.34s/it]3it [00:08,  2.50s/it]3it [00:07,  2.36s/it]4it [00:09,  2.26s/it]4it [00:09,  2.23s/it]4it [00:09,  2.27s/it]4it [00:09,  2.23s/it]4it [00:09,  2.28s/it]4it [00:09,  2.21s/it]4it [00:10,  2.32s/it]4it [00:09,  2.23s/it]5it [00:11,  2.17s/it]5it [00:11,  2.16s/it]5it [00:11,  2.20s/it]5it [00:11,  2.17s/it]5it [00:11,  2.18s/it]5it [00:11,  2.15s/it]5it [00:11,  2.16s/it]5it [00:12,  2.26s/it]6it [00:13,  2.12s/it]6it [00:13,  2.14s/it]6it [00:13,  2.13s/it]6it [00:13,  2.16s/it]6it [00:13,  2.17s/it]6it [00:13,  2.14s/it]6it [00:13,  2.11s/it]6it [00:14,  2.21s/it]7it [00:15,  2.09s/it]7it [00:15,  2.11s/it]7it [00:15,  2.11s/it]7it [00:15,  2.11s/it]7it [00:15,  2.12s/it]7it [00:15,  2.07s/it]7it [00:15,  2.12s/it]7it [00:16,  2.16s/it]8it [00:17,  2.06s/it]8it [00:17,  2.07s/it]8it [00:17,  2.09s/it]8it [00:17,  2.10s/it]8it [00:17,  2.09s/it]8it [00:17,  2.06s/it]8it [00:17,  2.14s/it]8it [00:18,  2.13s/it]9it [00:19,  2.04s/it]9it [00:19,  2.06s/it]9it [00:19,  2.07s/it]9it [00:19,  2.08s/it]9it [00:19,  2.09s/it]9it [00:19,  2.06s/it]9it [00:19,  2.11s/it]9it [00:20,  2.10s/it]10it [00:21,  2.04s/it]10it [00:21,  2.10s/it]10it [00:21,  2.07s/it]10it [00:22,  2.11s/it]10it [00:22,  2.08s/it]10it [00:21,  2.07s/it]10it [00:21,  2.09s/it]10it [00:22,  2.14s/it]11it [00:23,  2.08s/it]11it [00:23,  2.08s/it]11it [00:23,  2.06s/it]11it [00:24,  2.09s/it]11it [00:23,  2.05s/it]11it [00:23,  2.08s/it]11it [00:24,  2.07s/it]11it [00:24,  2.12s/it]12it [00:25,  2.06s/it]12it [00:25,  2.07s/it]12it [00:25,  2.07s/it]12it [00:26,  2.09s/it]12it [00:26,  2.07s/it]12it [00:26,  2.05s/it]12it [00:26,  2.11s/it]12it [00:26,  2.10s/it]13it [00:27,  2.05s/it]13it [00:28,  2.07s/it]13it [00:28,  2.11s/it]13it [00:28,  2.09s/it]13it [00:28,  2.05s/it]13it [00:28,  2.08s/it]13it [00:28,  2.09s/it]13it [00:28,  2.09s/it]14it [00:29,  2.03s/it]14it [00:29,  1.87s/it]14it [00:30,  2.08s/it]14it [00:30,  2.07s/it]14it [00:30,  2.09s/it]14it [00:30,  2.08s/it]14it [00:30,  2.11s/it]14it [00:30,  2.07s/it]15it [00:30,  1.74s/it]15it [00:31,  2.01s/it]15it [00:32,  2.07s/it]15it [00:32,  2.15s/it]15it [00:32,  2.17s/it]16it [00:32,  1.69s/it]15it [00:32,  2.09s/it]15it [00:33,  2.08s/it]15it [00:32,  2.13s/it]16it [00:33,  2.00s/it]17it [00:34,  1.63s/it]16it [00:34,  2.08s/it]16it [00:34,  2.12s/it]16it [00:34,  2.14s/it]16it [00:34,  2.08s/it]16it [00:34,  2.11s/it]16it [00:35,  2.08s/it]17it [00:35,  2.02s/it]18it [00:35,  1.57s/it]17it [00:36,  2.08s/it]17it [00:36,  2.09s/it]17it [00:36,  2.09s/it]17it [00:36,  2.07s/it]19it [00:36,  1.52s/it]17it [00:36,  2.11s/it]17it [00:37,  2.11s/it]18it [00:37,  2.04s/it]18it [00:38,  2.07s/it]18it [00:38,  2.07s/it]20it [00:38,  1.51s/it]18it [00:38,  2.09s/it]18it [00:38,  2.09s/it]18it [00:38,  2.12s/it]18it [00:39,  2.15s/it]19it [00:40,  2.09s/it]21it [00:39,  1.50s/it]19it [00:40,  2.07s/it]19it [00:40,  2.06s/it]19it [00:40,  2.11s/it]19it [00:40,  2.08s/it]19it [00:40,  2.09s/it]22it [00:41,  1.51s/it]19it [00:41,  2.13s/it]20it [00:42,  2.06s/it]20it [00:42,  2.05s/it]20it [00:42,  2.07s/it]20it [00:42,  2.10s/it]23it [00:42,  1.51s/it]20it [00:42,  2.09s/it]20it [00:42,  2.10s/it]21it [00:44,  2.06s/it]20it [00:43,  2.12s/it]24it [00:44,  1.49s/it]21it [00:44,  2.05s/it]21it [00:44,  2.04s/it]21it [00:44,  2.07s/it]21it [00:44,  2.08s/it]21it [00:45,  2.12s/it]22it [00:46,  2.07s/it]21it [00:45,  2.12s/it]25it [00:45,  1.48s/it]22it [00:46,  2.03s/it]22it [00:46,  2.05s/it]22it [00:46,  2.06s/it]22it [00:46,  2.07s/it]26it [00:47,  1.47s/it]22it [00:47,  2.09s/it]23it [00:48,  2.05s/it]22it [00:48,  2.12s/it]23it [00:48,  2.04s/it]23it [00:48,  2.04s/it]27it [00:48,  1.45s/it]23it [00:48,  2.04s/it]23it [00:48,  2.06s/it]23it [00:49,  2.07s/it]24it [00:50,  2.06s/it]23it [00:50,  2.14s/it]28it [00:50,  1.48s/it]24it [00:51,  2.06s/it]24it [00:50,  2.05s/it]24it [00:50,  2.04s/it]24it [00:50,  2.05s/it]24it [00:51,  2.06s/it]29it [00:51,  1.47s/it]25it [00:52,  2.07s/it]24it [00:52,  2.15s/it]25it [00:52,  2.05s/it]25it [00:53,  2.10s/it]25it [00:53,  2.05s/it]30it [00:53,  1.47s/it]25it [00:52,  2.04s/it]25it [00:53,  2.05s/it]26it [00:54,  2.07s/it]25it [00:54,  2.11s/it]31it [00:54,  1.46s/it]26it [00:54,  2.05s/it]26it [00:55,  2.09s/it]26it [00:55,  2.06s/it]26it [00:54,  2.05s/it]26it [00:55,  2.04s/it]27it [00:56,  2.04s/it]32it [00:56,  1.49s/it]26it [00:56,  2.11s/it]27it [00:57,  2.08s/it]27it [00:57,  2.07s/it]27it [00:57,  2.07s/it]27it [00:57,  2.06s/it]27it [00:57,  2.04s/it]33it [00:57,  1.50s/it]28it [00:58,  2.04s/it]27it [00:58,  2.09s/it]28it [00:59,  2.05s/it]28it [00:59,  2.08s/it]28it [00:59,  2.06s/it]28it [00:59,  2.05s/it]34it [00:59,  1.66s/it]28it [00:59,  2.06s/it]29it [01:00,  2.07s/it]28it [01:00,  2.07s/it]29it [01:01,  2.05s/it]29it [01:01,  2.06s/it]29it [01:01,  2.06s/it]29it [01:01,  2.05s/it]35it [01:01,  1.78s/it]29it [01:01,  2.08s/it]30it [01:02,  2.06s/it]29it [01:02,  2.10s/it]30it [01:03,  2.05s/it]30it [01:03,  2.06s/it]30it [01:03,  2.04s/it]30it [01:03,  2.05s/it]36it [01:03,  1.85s/it]30it [01:03,  2.06s/it]31it [01:04,  2.04s/it]30it [01:05,  2.15s/it]31it [01:05,  2.05s/it]31it [01:05,  2.07s/it]31it [01:05,  2.07s/it]31it [01:05,  2.05s/it]37it [01:05,  1.91s/it]32it [01:06,  2.02s/it]31it [01:05,  2.10s/it]31it [01:07,  2.12s/it]32it [01:07,  2.04s/it]32it [01:07,  2.10s/it]32it [01:07,  2.07s/it]32it [01:07,  2.05s/it]38it [01:07,  1.95s/it]33it [01:08,  2.02s/it]32it [01:07,  2.07s/it]32it [01:09,  2.14s/it]33it [01:09,  2.05s/it]33it [01:09,  2.05s/it]33it [01:09,  2.11s/it]33it [01:09,  2.05s/it]39it [01:09,  1.98s/it]34it [01:10,  2.03s/it]33it [01:09,  2.06s/it]34it [01:11,  2.06s/it]33it [01:11,  2.16s/it]34it [01:11,  2.06s/it]34it [01:11,  2.10s/it]34it [01:11,  2.05s/it]40it [01:11,  1.99s/it]34it [01:11,  2.04s/it]35it [01:12,  2.04s/it]35it [01:13,  2.05s/it]34it [01:13,  2.13s/it]35it [01:13,  2.08s/it]35it [01:13,  2.10s/it]35it [01:13,  2.05s/it]41it [01:14,  2.05s/it]36it [01:14,  2.04s/it]35it [01:13,  2.08s/it]36it [01:15,  2.07s/it]35it [01:15,  2.12s/it]36it [01:15,  2.07s/it]36it [01:15,  2.09s/it]36it [01:15,  2.03s/it]42it [01:16,  2.03s/it]37it [01:16,  2.02s/it]36it [01:15,  2.06s/it]37it [01:17,  2.08s/it]36it [01:17,  2.11s/it]37it [01:17,  2.06s/it]37it [01:17,  2.08s/it]37it [01:17,  2.05s/it]43it [01:18,  2.03s/it]38it [01:18,  2.04s/it]37it [01:18,  2.06s/it]38it [01:19,  2.08s/it]37it [01:19,  2.10s/it]38it [01:19,  2.07s/it]38it [01:19,  2.06s/it]38it [01:19,  2.06s/it]44it [01:20,  2.02s/it]39it [01:21,  2.04s/it]38it [01:20,  2.05s/it]39it [01:22,  2.08s/it]38it [01:21,  2.11s/it]39it [01:22,  2.09s/it]39it [01:22,  2.08s/it]39it [01:21,  2.05s/it]45it [01:22,  2.02s/it]40it [01:23,  2.05s/it]39it [01:22,  2.06s/it]40it [01:24,  2.08s/it]39it [01:24,  2.10s/it]40it [01:24,  2.09s/it]40it [01:23,  2.05s/it]40it [01:24,  2.14s/it]46it [01:24,  2.05s/it]41it [01:25,  2.03s/it]40it [01:24,  2.08s/it]41it [01:26,  2.06s/it]40it [01:26,  2.12s/it]41it [01:26,  2.09s/it]41it [01:25,  2.04s/it]41it [01:26,  2.10s/it]47it [01:26,  2.07s/it]41it [01:26,  2.07s/it]42it [01:27,  2.13s/it]41it [01:28,  2.11s/it]42it [01:28,  2.17s/it]42it [01:27,  2.04s/it]42it [01:28,  2.18s/it]48it [01:28,  2.05s/it]42it [01:28,  2.18s/it]43it [01:29,  2.09s/it]42it [01:28,  2.14s/it]42it [01:30,  2.11s/it]43it [01:30,  2.15s/it]43it [01:30,  2.15s/it]49it [01:30,  2.07s/it]43it [01:30,  2.14s/it]43it [01:30,  2.16s/it]44it [01:31,  2.07s/it]43it [01:30,  2.12s/it]44it [01:32,  2.15s/it]44it [01:32,  2.12s/it]44it [01:32,  2.12s/it]44it [01:32,  2.15s/it]50it [01:32,  2.11s/it]45it [01:33,  2.06s/it]43it [01:33,  2.29s/it]44it [01:32,  2.07s/it]45it [01:34,  2.12s/it]45it [01:34,  2.10s/it]45it [01:34,  2.10s/it]45it [01:34,  2.14s/it]46it [01:35,  2.07s/it]44it [01:35,  2.23s/it]45it [01:34,  2.06s/it]51it [01:35,  2.20s/it]46it [01:36,  2.09s/it]46it [01:36,  2.12s/it]46it [01:37,  2.11s/it]46it [01:36,  2.10s/it]47it [01:37,  2.06s/it]45it [01:37,  2.18s/it]46it [01:36,  2.05s/it]52it [01:37,  2.16s/it]47it [01:38,  2.06s/it]47it [01:38,  2.10s/it]47it [01:39,  2.09s/it]48it [01:39,  2.05s/it]47it [01:38,  2.12s/it]47it [01:38,  2.07s/it]46it [01:39,  2.21s/it]53it [01:39,  2.14s/it]48it [01:40,  2.07s/it]48it [01:41,  2.09s/it]48it [01:41,  2.07s/it]49it [01:41,  2.07s/it]48it [01:40,  2.10s/it]48it [01:40,  2.07s/it]47it [01:41,  2.16s/it]54it [01:41,  2.15s/it]49it [01:43,  2.07s/it]49it [01:43,  2.08s/it]50it [01:43,  2.07s/it]49it [01:42,  2.10s/it]49it [01:43,  2.13s/it]48it [01:43,  2.14s/it]49it [01:43,  2.09s/it]55it [01:43,  2.12s/it]50it [01:45,  2.07s/it]50it [01:45,  2.13s/it]51it [01:45,  2.09s/it]50it [01:44,  2.10s/it]50it [01:45,  2.12s/it]50it [01:45,  2.09s/it]49it [01:45,  2.13s/it]56it [01:45,  2.13s/it]51it [01:47,  2.04s/it]51it [01:47,  2.12s/it]52it [01:48,  2.09s/it]51it [01:47,  2.09s/it]51it [01:47,  2.12s/it]51it [01:47,  2.08s/it]50it [01:47,  2.15s/it]57it [01:47,  2.11s/it]52it [01:49,  2.02s/it]52it [01:49,  2.11s/it]53it [01:50,  2.09s/it]52it [01:49,  2.11s/it]52it [01:49,  2.11s/it]52it [01:49,  2.08s/it]51it [01:50,  2.13s/it]58it [01:49,  2.09s/it]53it [01:51,  2.02s/it]54it [01:52,  2.07s/it]53it [01:51,  2.13s/it]53it [01:51,  2.08s/it]53it [01:51,  2.15s/it]53it [01:51,  2.08s/it]52it [01:52,  2.10s/it]59it [01:51,  2.10s/it]54it [01:53,  2.00s/it]55it [01:54,  2.06s/it]54it [01:53,  2.14s/it]54it [01:53,  2.12s/it]54it [01:53,  2.07s/it]54it [01:53,  2.14s/it]53it [01:54,  2.08s/it]60it [01:53,  2.07s/it]55it [01:55,  2.02s/it]56it [01:56,  2.08s/it]55it [01:56,  2.13s/it]55it [01:56,  2.12s/it]55it [01:55,  2.12s/it]55it [01:55,  2.09s/it]54it [01:56,  2.08s/it]61it [01:55,  2.06s/it]56it [01:57,  2.01s/it]57it [01:58,  2.08s/it]56it [01:58,  2.11s/it]56it [01:58,  2.12s/it]56it [01:57,  2.09s/it]55it [01:58,  2.07s/it]62it [01:57,  2.06s/it]56it [01:57,  2.16s/it]57it [01:59,  2.00s/it]58it [02:00,  2.07s/it]57it [01:59,  2.08s/it]56it [02:00,  2.08s/it]57it [02:00,  2.14s/it]63it [02:00,  2.08s/it]57it [02:00,  2.15s/it]57it [01:59,  2.15s/it]58it [02:01,  2.01s/it]59it [02:02,  2.07s/it]58it [02:01,  2.08s/it]57it [02:02,  2.08s/it]64it [02:02,  2.08s/it]58it [02:02,  2.14s/it]58it [02:02,  2.12s/it]58it [02:01,  2.12s/it]59it [02:03,  2.02s/it]60it [02:04,  2.09s/it]59it [02:03,  2.08s/it]58it [02:04,  2.08s/it]59it [02:04,  2.10s/it]59it [02:04,  2.16s/it]59it [02:04,  2.13s/it]65it [02:04,  2.15s/it]60it [02:05,  2.05s/it]61it [02:06,  2.16s/it]59it [02:06,  2.08s/it]60it [02:05,  2.10s/it]60it [02:06,  2.09s/it]60it [02:06,  2.12s/it]66it [02:06,  2.12s/it]60it [02:06,  2.13s/it]61it [02:07,  2.04s/it]62it [02:09,  2.14s/it]60it [02:08,  2.07s/it]61it [02:08,  2.09s/it]61it [02:08,  2.08s/it]61it [02:08,  2.09s/it]67it [02:08,  2.11s/it]61it [02:08,  2.12s/it]62it [02:09,  2.05s/it]61it [02:10,  2.08s/it]62it [02:10,  2.08s/it]62it [02:10,  2.11s/it]63it [02:11,  2.18s/it]62it [02:10,  2.14s/it]68it [02:10,  2.11s/it]62it [02:10,  2.14s/it]63it [02:11,  2.04s/it]62it [02:12,  2.06s/it]63it [02:12,  2.07s/it]63it [02:12,  2.11s/it]69it [02:12,  2.09s/it]63it [02:12,  2.13s/it]64it [02:13,  2.02s/it]64it [02:13,  2.22s/it]63it [02:12,  2.15s/it]63it [02:14,  2.05s/it]64it [02:14,  2.07s/it]64it [02:14,  2.09s/it]70it [02:14,  2.09s/it]64it [02:15,  2.12s/it]65it [02:15,  2.03s/it]65it [02:15,  2.19s/it]64it [02:14,  2.14s/it]64it [02:16,  2.04s/it]65it [02:16,  2.05s/it]65it [02:16,  2.09s/it]66it [02:17,  2.03s/it]71it [02:16,  2.11s/it]66it [02:17,  2.14s/it]65it [02:17,  2.13s/it]65it [02:16,  2.15s/it]65it [02:18,  2.07s/it]66it [02:18,  2.04s/it]66it [02:18,  2.11s/it]67it [02:19,  2.03s/it]67it [02:19,  2.11s/it]72it [02:19,  2.10s/it]66it [02:19,  2.12s/it]66it [02:18,  2.13s/it]67it [02:20,  2.05s/it]66it [02:21,  2.10s/it]68it [02:21,  2.03s/it]68it [02:21,  2.08s/it]67it [02:20,  2.11s/it]67it [02:21,  2.09s/it]73it [02:21,  2.10s/it]67it [02:21,  2.10s/it]68it [02:23,  2.06s/it]67it [02:23,  2.11s/it]69it [02:23,  2.03s/it]69it [02:23,  2.07s/it]68it [02:22,  2.12s/it]68it [02:23,  2.08s/it]68it [02:23,  2.10s/it]74it [02:23,  2.20s/it]69it [02:25,  2.05s/it]68it [02:25,  2.08s/it]70it [02:25,  2.05s/it]69it [02:25,  2.07s/it]69it [02:24,  2.11s/it]70it [02:26,  2.10s/it]69it [02:25,  2.08s/it]75it [02:25,  2.19s/it]70it [02:27,  2.05s/it]70it [02:26,  1.89s/it]69it [02:27,  2.08s/it]71it [02:27,  2.04s/it]70it [02:27,  2.06s/it]70it [02:27,  2.09s/it]71it [02:28,  2.10s/it]76it [02:27,  2.14s/it]71it [02:28,  1.80s/it]71it [02:29,  2.04s/it]70it [02:29,  2.07s/it]72it [02:29,  2.05s/it]71it [02:29,  2.08s/it]71it [02:29,  2.08s/it]72it [02:30,  2.08s/it]77it [02:29,  2.10s/it]72it [02:29,  1.68s/it]72it [02:31,  2.09s/it]71it [02:31,  2.06s/it]73it [02:31,  2.05s/it]73it [02:31,  1.59s/it]72it [02:31,  2.06s/it]72it [02:31,  2.08s/it]73it [02:32,  2.08s/it]78it [02:31,  2.08s/it]74it [02:32,  1.55s/it]72it [02:33,  2.06s/it]73it [02:33,  2.10s/it]74it [02:33,  2.04s/it]73it [02:33,  2.05s/it]73it [02:33,  2.07s/it]74it [02:34,  2.09s/it]79it [02:33,  2.07s/it]75it [02:33,  1.54s/it]73it [02:35,  2.05s/it]75it [02:35,  2.06s/it]74it [02:35,  2.14s/it]74it [02:35,  2.06s/it]74it [02:35,  2.06s/it]75it [02:36,  2.08s/it]76it [02:35,  1.50s/it]80it [02:35,  2.07s/it]77it [02:36,  1.48s/it]74it [02:37,  2.05s/it]76it [02:37,  2.07s/it]75it [02:37,  2.13s/it]75it [02:37,  2.09s/it]75it [02:37,  2.08s/it]76it [02:38,  2.07s/it]81it [02:38,  2.08s/it]78it [02:38,  1.46s/it]75it [02:39,  2.05s/it]76it [02:39,  2.12s/it]77it [02:40,  2.09s/it]76it [02:39,  2.07s/it]77it [02:40,  2.07s/it]76it [02:39,  2.10s/it]79it [02:39,  1.45s/it]82it [02:40,  2.07s/it]76it [02:41,  2.05s/it]80it [02:41,  1.44s/it]77it [02:41,  2.10s/it]78it [02:42,  2.09s/it]77it [02:42,  2.08s/it]77it [02:41,  2.10s/it]78it [02:42,  2.09s/it]83it [02:42,  2.06s/it]81it [02:42,  1.51s/it]77it [02:43,  2.05s/it]78it [02:44,  2.09s/it]79it [02:44,  2.08s/it]78it [02:44,  2.06s/it]78it [02:43,  2.09s/it]79it [02:44,  2.08s/it]84it [02:44,  2.06s/it]82it [02:44,  1.48s/it]78it [02:45,  2.07s/it]79it [02:46,  2.09s/it]80it [02:46,  2.09s/it]80it [02:46,  2.05s/it]79it [02:46,  2.08s/it]83it [02:45,  1.49s/it]79it [02:45,  2.09s/it]85it [02:46,  2.07s/it]84it [02:47,  1.49s/it]79it [02:47,  2.06s/it]81it [02:48,  2.08s/it]80it [02:48,  2.07s/it]81it [02:48,  2.07s/it]80it [02:47,  2.07s/it]80it [02:48,  2.14s/it]86it [02:48,  2.06s/it]85it [02:48,  1.47s/it]80it [02:49,  2.07s/it]82it [02:50,  2.05s/it]81it [02:50,  2.07s/it]82it [02:50,  2.11s/it]81it [02:49,  2.07s/it]81it [02:50,  2.15s/it]86it [02:49,  1.45s/it]87it [02:50,  2.06s/it]81it [02:51,  2.05s/it]87it [02:51,  1.46s/it]83it [02:52,  2.05s/it]82it [02:51,  2.06s/it]82it [02:52,  2.08s/it]83it [02:52,  2.10s/it]82it [02:52,  2.14s/it]88it [02:52,  2.06s/it]88it [02:52,  1.48s/it]82it [02:54,  2.07s/it]84it [02:54,  2.04s/it]83it [02:54,  2.08s/it]83it [02:53,  2.08s/it]84it [02:54,  2.12s/it]83it [02:54,  2.12s/it]89it [02:54,  2.08s/it]89it [02:54,  1.96s/it]
89it [02:54,  1.47s/it]89it [02:54,  1.96s/it]
83it [02:56,  2.05s/it]84it [02:55,  2.05s/it]84it [02:56,  2.09s/it]85it [02:57,  2.11s/it]85it [02:57,  2.18s/it]84it [02:57,  2.18s/it]84it [02:58,  2.09s/it]86it [02:59,  2.07s/it]85it [02:58,  2.12s/it]86it [02:59,  2.14s/it]85it [02:58,  2.18s/it]85it [02:59,  2.18s/it]85it [03:00,  2.08s/it]87it [03:01,  2.06s/it]86it [03:00,  2.10s/it]87it [03:01,  2.11s/it]86it [03:01,  2.13s/it]86it [03:01,  2.16s/it]86it [03:02,  2.05s/it]88it [03:03,  2.06s/it]87it [03:02,  2.07s/it]88it [03:03,  2.08s/it]87it [03:03,  2.14s/it]87it [03:03,  2.10s/it]87it [03:04,  2.03s/it]89it [03:05,  2.08s/it]89it [03:05,  2.08s/it]
88it [03:04,  2.05s/it]89it [03:05,  2.06s/it]89it [03:05,  2.08s/it]
88it [03:05,  2.13s/it]88it [03:05,  2.11s/it]88it [03:06,  2.02s/it]89it [03:06,  2.05s/it]89it [03:06,  2.09s/it]
89it [03:07,  2.10s/it]89it [03:07,  2.11s/it]
89it [03:07,  2.07s/it]89it [03:07,  2.11s/it]
89it [03:08,  2.02s/it]89it [03:08,  2.12s/it]
tensor(0.)
avg vtokens tensor(354.3258)
avg total tokens 7635.693820224719
Evaluating newsvqa_val ...
Results saved to ./res/news-vqa/newsvqa_val_241226204024.json
python utils/infographicsvqa_eval.py -g /gruntdata/heyuan67/zqp/NewsVQA/ICDAR2023/annotation/swift_newsvideoqa_version_2_val_release2.json -s ./res/news-vqa/newsvqa_val_241226204024.json

Overall ANLS: 0.6918
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-newsvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val-unsupervised-cls-v3-top3 == vqa-slidevqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
