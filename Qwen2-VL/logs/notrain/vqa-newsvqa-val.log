+ CHECKPOINT=/gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
+ DATASET=vqa-newsvqa-val
+ GPUS=8
+ CHECKPOINT=/gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
++ pwd
+ export PYTHONPATH=/mntnlp/zqp/physical_report/Qwen2-VL:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public
+ PYTHONPATH=/mntnlp/zqp/physical_report/Qwen2-VL:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public:/root/miniconda3/lib/python3.10/site-packages/aistudio_notebook/public
+ echo 'CHECKPOINT: /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct'
CHECKPOINT: /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct
+ MASTER_PORT=58072
+ PORT=62621
+ GPUS=8
+ export MASTER_PORT=58072
+ MASTER_PORT=58072
+ export PORT=62621
+ PORT=62621
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val == vqa-mpdocvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val == vqa-dude-mpdocvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val ']'
+ torchrun --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --nproc_per_node=8 --master_port=58072 infer_mpdocvqa_dynamic.py --checkpoint /gruntdata/heyuan67/huoluo.wx/models/Qwen__Qwen2-VL-7B-Instruct --max-pixels 200704 --datasets newsvqa_val --out-dir ./res/news-vqa
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
datasets: ['newsvqa_val']
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:00,  4.31it/s]Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.55it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.67it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.92it/s]Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.90it/s]Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.66it/s]`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
Unrecognized keys in `rope_scaling` for 'rope_type'='default': {'mrope_section'}
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
You are attempting to use Flash Attention 2.0 without specifying a torch dtype. This might lead to unexpected behaviour
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
`Qwen2VLRotaryEmbedding` can now be fully parameterized by passing the model config through the `config` argument. All other arguments will be removed in v4.46
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  5.12it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.91it/s]
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.79it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:00,  4.04it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.86it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.80it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.82it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.79it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.76it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:00<00:01,  3.02it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.37it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.36it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.32it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.89it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.77it/s]
Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.31it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  4.29it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.46it/s]Loading checkpoint shards:  40%|████      | 2/5 [00:00<00:00,  3.28it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.48it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.44it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.41it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  4.39it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.53it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.56it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.52it/s]Loading checkpoint shards:  60%|██████    | 3/5 [00:00<00:00,  3.37it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.50it/s]Loading checkpoint shards:  80%|████████  | 4/5 [00:00<00:00,  4.48it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.57it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.49it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.64it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.52it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.60it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.48it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.58it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.46it/s]
Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.57it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  4.45it/s]
Loading checkpoint shards:  80%|████████  | 4/5 [00:01<00:00,  3.42it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  3.41it/s]Loading checkpoint shards: 100%|██████████| 5/5 [00:01<00:00,  3.37it/s]
0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]0it [00:00, ?it/s]1it [00:02,  2.25s/it]1it [00:02,  2.11s/it]2it [00:03,  1.37s/it]1it [00:02,  2.21s/it]2it [00:02,  1.29s/it]1it [00:02,  2.12s/it]1it [00:02,  2.41s/it]3it [00:03,  1.08s/it]2it [00:03,  1.38s/it]2it [00:02,  1.31s/it]1it [00:02,  2.37s/it]3it [00:03,  1.15s/it]1it [00:02,  2.51s/it]2it [00:03,  1.43s/it]3it [00:03,  1.09s/it]1it [00:02,  2.83s/it]4it [00:04,  1.00it/s]3it [00:03,  1.05s/it]2it [00:03,  1.39s/it]4it [00:04,  1.01s/it]2it [00:03,  1.45s/it]3it [00:03,  1.12s/it]4it [00:04,  1.05it/s]5it [00:05,  1.12it/s]2it [00:03,  1.63s/it]3it [00:03,  1.11s/it]5it [00:05,  1.11it/s]4it [00:04,  1.01it/s]4it [00:04,  1.03it/s]3it [00:04,  1.23s/it]5it [00:05,  1.14it/s]6it [00:06,  1.19it/s]3it [00:04,  1.25s/it]4it [00:04,  1.02it/s]5it [00:05,  1.11it/s]6it [00:06,  1.13it/s]5it [00:05,  1.13it/s]4it [00:04,  1.04s/it]7it [00:06,  1.25it/s]4it [00:05,  1.04s/it]6it [00:06,  1.16it/s]5it [00:05,  1.10it/s]6it [00:06,  1.17it/s]7it [00:06,  1.20it/s]6it [00:06,  1.20it/s]5it [00:05,  1.06it/s]8it [00:07,  1.29it/s]7it [00:06,  1.18it/s]5it [00:05,  1.04it/s]6it [00:06,  1.16it/s]8it [00:07,  1.24it/s]7it [00:06,  1.21it/s]7it [00:06,  1.26it/s]6it [00:06,  1.13it/s]9it [00:08,  1.32it/s]6it [00:06,  1.10it/s]8it [00:07,  1.17it/s]7it [00:06,  1.20it/s]8it [00:07,  1.26it/s]9it [00:08,  1.26it/s]8it [00:07,  1.29it/s]7it [00:07,  1.21it/s]10it [00:08,  1.31it/s]7it [00:07,  1.16it/s]9it [00:08,  1.22it/s]9it [00:08,  1.30it/s]8it [00:07,  1.23it/s]10it [00:09,  1.28it/s]9it [00:08,  1.30it/s]8it [00:07,  1.25it/s]11it [00:09,  1.25it/s]10it [00:09,  1.25it/s]8it [00:08,  1.19it/s]11it [00:09,  1.31it/s]9it [00:08,  1.24it/s]10it [00:09,  1.26it/s]10it [00:09,  1.29it/s]9it [00:08,  1.29it/s]12it [00:10,  1.27it/s]9it [00:09,  1.25it/s]11it [00:10,  1.28it/s]11it [00:09,  1.28it/s]10it [00:09,  1.26it/s]12it [00:10,  1.28it/s]11it [00:09,  1.28it/s]10it [00:09,  1.22it/s]13it [00:11,  1.28it/s]12it [00:10,  1.31it/s]12it [00:10,  1.32it/s]13it [00:11,  1.32it/s]11it [00:10,  1.28it/s]10it [00:10,  1.17it/s]12it [00:10,  1.23it/s]11it [00:10,  1.26it/s]14it [00:12,  1.30it/s]13it [00:11,  1.26it/s]14it [00:12,  1.32it/s]11it [00:10,  1.22it/s]12it [00:10,  1.27it/s]13it [00:11,  1.24it/s]13it [00:11,  1.25it/s]12it [00:11,  1.24it/s]15it [00:12,  1.32it/s]15it [00:12,  1.33it/s]14it [00:12,  1.22it/s]12it [00:11,  1.24it/s]14it [00:12,  1.28it/s]13it [00:11,  1.22it/s]14it [00:12,  1.26it/s]16it [00:13,  1.34it/s]13it [00:11,  1.26it/s]13it [00:12,  1.27it/s]16it [00:13,  1.27it/s]14it [00:12,  1.26it/s]15it [00:13,  1.19it/s]15it [00:13,  1.20it/s]15it [00:13,  1.25it/s]17it [00:14,  1.33it/s]14it [00:12,  1.24it/s]14it [00:13,  1.31it/s]17it [00:14,  1.27it/s]16it [00:14,  1.23it/s]16it [00:13,  1.25it/s]16it [00:13,  1.29it/s]15it [00:13,  1.29it/s]18it [00:15,  1.30it/s]15it [00:13,  1.13it/s]15it [00:13,  1.29it/s]18it [00:15,  1.30it/s]17it [00:14,  1.25it/s]17it [00:14,  1.29it/s]17it [00:14,  1.30it/s]16it [00:14,  1.17it/s]16it [00:14,  1.25it/s]19it [00:16,  1.25it/s]19it [00:16,  1.33it/s]16it [00:14,  1.31it/s]18it [00:15,  1.32it/s]18it [00:15,  1.22it/s]18it [00:15,  1.30it/s]17it [00:15,  1.23it/s]20it [00:16,  1.29it/s]17it [00:15,  1.25it/s]20it [00:16,  1.32it/s]17it [00:15,  1.28it/s]19it [00:15,  1.34it/s]19it [00:16,  1.25it/s]19it [00:16,  1.32it/s]18it [00:15,  1.24it/s]21it [00:17,  1.28it/s]18it [00:15,  1.26it/s]21it [00:17,  1.33it/s]20it [00:16,  1.35it/s]18it [00:16,  1.22it/s]20it [00:16,  1.31it/s]20it [00:17,  1.24it/s]19it [00:16,  1.29it/s]22it [00:18,  1.26it/s]19it [00:16,  1.20it/s]21it [00:17,  1.37it/s]22it [00:18,  1.28it/s]19it [00:17,  1.24it/s]21it [00:17,  1.32it/s]21it [00:18,  1.20it/s]20it [00:17,  1.29it/s]23it [00:19,  1.28it/s]20it [00:17,  1.22it/s]22it [00:18,  1.34it/s]23it [00:19,  1.27it/s]20it [00:17,  1.26it/s]22it [00:18,  1.33it/s]22it [00:18,  1.25it/s]21it [00:18,  1.32it/s]24it [00:19,  1.30it/s]21it [00:18,  1.27it/s]23it [00:18,  1.34it/s]24it [00:19,  1.29it/s]23it [00:19,  1.35it/s]21it [00:18,  1.24it/s]23it [00:19,  1.29it/s]22it [00:18,  1.34it/s]22it [00:18,  1.29it/s]25it [00:20,  1.27it/s]24it [00:19,  1.33it/s]25it [00:20,  1.30it/s]24it [00:19,  1.36it/s]22it [00:19,  1.25it/s]24it [00:20,  1.30it/s]23it [00:19,  1.32it/s]23it [00:19,  1.31it/s]26it [00:21,  1.27it/s]25it [00:20,  1.35it/s]26it [00:21,  1.31it/s]25it [00:20,  1.37it/s]25it [00:21,  1.30it/s]23it [00:20,  1.24it/s]24it [00:20,  1.29it/s]24it [00:20,  1.30it/s]27it [00:22,  1.30it/s]26it [00:21,  1.35it/s]27it [00:22,  1.34it/s]26it [00:21,  1.36it/s]26it [00:21,  1.31it/s]24it [00:21,  1.22it/s]28it [00:22,  1.32it/s]25it [00:21,  1.29it/s]25it [00:21,  1.22it/s]27it [00:21,  1.31it/s]28it [00:22,  1.31it/s]27it [00:22,  1.32it/s]27it [00:22,  1.32it/s]25it [00:21,  1.26it/s]26it [00:22,  1.29it/s]29it [00:23,  1.27it/s]26it [00:22,  1.23it/s]28it [00:22,  1.31it/s]29it [00:23,  1.32it/s]28it [00:22,  1.34it/s]28it [00:23,  1.32it/s]26it [00:22,  1.24it/s]30it [00:24,  1.30it/s]27it [00:22,  1.28it/s]29it [00:23,  1.33it/s]27it [00:22,  1.25it/s]30it [00:24,  1.32it/s]29it [00:23,  1.34it/s]29it [00:24,  1.28it/s]27it [00:23,  1.27it/s]28it [00:23,  1.31it/s]31it [00:25,  1.31it/s]30it [00:24,  1.35it/s]28it [00:23,  1.29it/s]31it [00:25,  1.34it/s]30it [00:24,  1.35it/s]30it [00:25,  1.30it/s]28it [00:24,  1.30it/s]32it [00:26,  1.33it/s]29it [00:24,  1.30it/s]31it [00:24,  1.35it/s]29it [00:24,  1.30it/s]31it [00:25,  1.35it/s]32it [00:26,  1.28it/s]31it [00:25,  1.23it/s]29it [00:25,  1.26it/s]33it [00:26,  1.34it/s]30it [00:25,  1.33it/s]30it [00:25,  1.29it/s]32it [00:25,  1.35it/s]32it [00:25,  1.28it/s]33it [00:26,  1.26it/s]32it [00:26,  1.27it/s]34it [00:27,  1.34it/s]31it [00:25,  1.29it/s]31it [00:25,  1.30it/s]33it [00:26,  1.36it/s]30it [00:25,  1.19it/s]33it [00:26,  1.27it/s]34it [00:27,  1.28it/s]33it [00:27,  1.30it/s]35it [00:28,  1.30it/s]32it [00:26,  1.29it/s]32it [00:26,  1.32it/s]31it [00:26,  1.24it/s]34it [00:27,  1.35it/s]34it [00:27,  1.29it/s]35it [00:28,  1.28it/s]34it [00:28,  1.32it/s]33it [00:27,  1.32it/s]36it [00:29,  1.29it/s]35it [00:27,  1.36it/s]33it [00:27,  1.28it/s]35it [00:28,  1.32it/s]32it [00:27,  1.22it/s]36it [00:29,  1.30it/s]35it [00:29,  1.24it/s]37it [00:29,  1.32it/s]34it [00:28,  1.31it/s]36it [00:28,  1.36it/s]36it [00:28,  1.34it/s]34it [00:28,  1.27it/s]33it [00:28,  1.20it/s]37it [00:29,  1.30it/s]36it [00:29,  1.27it/s]35it [00:28,  1.32it/s]37it [00:29,  1.33it/s]38it [00:30,  1.28it/s]37it [00:29,  1.35it/s]35it [00:29,  1.29it/s]34it [00:29,  1.24it/s]38it [00:30,  1.30it/s]37it [00:30,  1.27it/s]39it [00:31,  1.31it/s]38it [00:30,  1.36it/s]36it [00:29,  1.30it/s]38it [00:30,  1.32it/s]36it [00:29,  1.27it/s]35it [00:29,  1.26it/s]39it [00:31,  1.30it/s]38it [00:31,  1.29it/s]39it [00:30,  1.34it/s]40it [00:32,  1.30it/s]37it [00:30,  1.29it/s]39it [00:31,  1.33it/s]37it [00:30,  1.27it/s]36it [00:30,  1.26it/s]40it [00:32,  1.31it/s]39it [00:32,  1.29it/s]41it [00:32,  1.32it/s]38it [00:31,  1.32it/s]40it [00:31,  1.33it/s]40it [00:31,  1.32it/s]37it [00:31,  1.28it/s]38it [00:31,  1.26it/s]41it [00:33,  1.26it/s]41it [00:32,  1.34it/s]41it [00:32,  1.34it/s]42it [00:33,  1.29it/s]40it [00:32,  1.26it/s]39it [00:32,  1.27it/s]39it [00:32,  1.26it/s]38it [00:32,  1.27it/s]42it [00:33,  1.30it/s]42it [00:33,  1.35it/s]43it [00:34,  1.32it/s]42it [00:33,  1.32it/s]41it [00:33,  1.28it/s]40it [00:32,  1.29it/s]39it [00:32,  1.29it/s]40it [00:33,  1.26it/s]43it [00:34,  1.31it/s]43it [00:33,  1.33it/s]44it [00:35,  1.33it/s]42it [00:34,  1.31it/s]41it [00:33,  1.32it/s]43it [00:34,  1.30it/s]44it [00:35,  1.33it/s]41it [00:33,  1.27it/s]40it [00:33,  1.26it/s]45it [00:35,  1.32it/s]43it [00:35,  1.30it/s]44it [00:34,  1.30it/s]42it [00:34,  1.33it/s]44it [00:34,  1.31it/s]45it [00:35,  1.34it/s]42it [00:34,  1.28it/s]41it [00:34,  1.27it/s]44it [00:35,  1.32it/s]46it [00:36,  1.31it/s]45it [00:35,  1.30it/s]45it [00:35,  1.32it/s]43it [00:35,  1.32it/s]46it [00:36,  1.31it/s]42it [00:35,  1.29it/s]43it [00:35,  1.26it/s]45it [00:36,  1.34it/s]47it [00:37,  1.33it/s]46it [00:36,  1.32it/s]44it [00:35,  1.31it/s]46it [00:36,  1.29it/s]47it [00:37,  1.31it/s]44it [00:36,  1.24it/s]43it [00:36,  1.21it/s]46it [00:37,  1.34it/s]48it [00:38,  1.34it/s]47it [00:37,  1.28it/s]47it [00:37,  1.30it/s]45it [00:36,  1.29it/s]48it [00:38,  1.33it/s]45it [00:36,  1.27it/s]44it [00:37,  1.23it/s]47it [00:38,  1.32it/s]49it [00:38,  1.30it/s]48it [00:37,  1.29it/s]48it [00:37,  1.32it/s]46it [00:37,  1.27it/s]49it [00:39,  1.32it/s]46it [00:37,  1.28it/s]45it [00:37,  1.25it/s]50it [00:39,  1.32it/s]49it [00:38,  1.34it/s]49it [00:38,  1.32it/s]48it [00:38,  1.27it/s]47it [00:38,  1.30it/s]50it [00:39,  1.26it/s]47it [00:38,  1.30it/s]46it [00:38,  1.19it/s]51it [00:40,  1.30it/s]50it [00:39,  1.31it/s]49it [00:39,  1.27it/s]48it [00:38,  1.33it/s]50it [00:39,  1.28it/s]51it [00:40,  1.27it/s]48it [00:39,  1.28it/s]52it [00:41,  1.32it/s]51it [00:40,  1.32it/s]47it [00:39,  1.21it/s]50it [00:40,  1.28it/s]51it [00:40,  1.29it/s]49it [00:39,  1.24it/s]52it [00:41,  1.28it/s]49it [00:40,  1.27it/s]53it [00:41,  1.32it/s]52it [00:40,  1.32it/s]48it [00:40,  1.23it/s]51it [00:41,  1.29it/s]52it [00:41,  1.26it/s]50it [00:40,  1.25it/s]53it [00:42,  1.28it/s]50it [00:40,  1.28it/s]54it [00:42,  1.34it/s]53it [00:41,  1.33it/s]52it [00:42,  1.29it/s]49it [00:41,  1.23it/s]51it [00:41,  1.28it/s]53it [00:41,  1.25it/s]51it [00:41,  1.31it/s]54it [00:43,  1.24it/s]55it [00:43,  1.33it/s]53it [00:42,  1.29it/s]54it [00:42,  1.23it/s]50it [00:42,  1.21it/s]54it [00:42,  1.23it/s]52it [00:42,  1.25it/s]52it [00:42,  1.32it/s]55it [00:43,  1.25it/s]56it [00:44,  1.28it/s]54it [00:43,  1.30it/s]55it [00:43,  1.26it/s]51it [00:42,  1.25it/s]55it [00:43,  1.24it/s]53it [00:43,  1.19it/s]53it [00:43,  1.31it/s]56it [00:44,  1.23it/s]57it [00:45,  1.31it/s]55it [00:44,  1.30it/s]52it [00:43,  1.26it/s]56it [00:44,  1.27it/s]56it [00:44,  1.15it/s]54it [00:43,  1.23it/s]54it [00:43,  1.32it/s]57it [00:45,  1.25it/s]58it [00:45,  1.33it/s]56it [00:45,  1.29it/s]53it [00:44,  1.28it/s]57it [00:45,  1.23it/s]57it [00:45,  1.18it/s]55it [00:44,  1.31it/s]55it [00:44,  1.24it/s]58it [00:46,  1.29it/s]59it [00:46,  1.31it/s]57it [00:45,  1.31it/s]54it [00:45,  1.30it/s]58it [00:45,  1.24it/s]56it [00:45,  1.32it/s]58it [00:45,  1.22it/s]56it [00:45,  1.23it/s]59it [00:47,  1.26it/s]60it [00:47,  1.28it/s]55it [00:45,  1.31it/s]58it [00:46,  1.27it/s]59it [00:46,  1.25it/s]57it [00:46,  1.33it/s]59it [00:46,  1.20it/s]60it [00:47,  1.30it/s]57it [00:46,  1.19it/s]56it [00:46,  1.33it/s]59it [00:47,  1.29it/s]61it [00:48,  1.18it/s]58it [00:46,  1.33it/s]60it [00:47,  1.24it/s]60it [00:47,  1.25it/s]61it [00:48,  1.32it/s]58it [00:47,  1.23it/s]57it [00:47,  1.35it/s]60it [00:48,  1.28it/s]62it [00:49,  1.22it/s]59it [00:47,  1.30it/s]61it [00:48,  1.26it/s]61it [00:48,  1.29it/s]62it [00:49,  1.31it/s]59it [00:47,  1.25it/s]58it [00:48,  1.33it/s]61it [00:49,  1.28it/s]63it [00:50,  1.17it/s]60it [00:48,  1.28it/s]62it [00:49,  1.30it/s]62it [00:49,  1.22it/s]63it [00:50,  1.28it/s]60it [00:48,  1.27it/s]59it [00:48,  1.34it/s]62it [00:49,  1.27it/s]63it [00:49,  1.33it/s]61it [00:49,  1.28it/s]64it [00:51,  1.12it/s]61it [00:49,  1.29it/s]64it [00:50,  1.28it/s]63it [00:49,  1.21it/s]60it [00:49,  1.33it/s]63it [00:50,  1.28it/s]64it [00:50,  1.35it/s]62it [00:50,  1.27it/s]65it [00:51,  1.17it/s]64it [00:50,  1.23it/s]61it [00:50,  1.32it/s]62it [00:50,  1.20it/s]65it [00:51,  1.18it/s]64it [00:51,  1.31it/s]65it [00:51,  1.36it/s]63it [00:50,  1.31it/s]66it [00:52,  1.22it/s]62it [00:51,  1.34it/s]65it [00:51,  1.20it/s]63it [00:51,  1.22it/s]66it [00:52,  1.21it/s]65it [00:52,  1.32it/s]66it [00:51,  1.37it/s]64it [00:51,  1.33it/s]67it [00:53,  1.27it/s]63it [00:51,  1.36it/s]66it [00:52,  1.24it/s]64it [00:51,  1.25it/s]67it [00:53,  1.25it/s]66it [00:52,  1.28it/s]67it [00:52,  1.35it/s]65it [00:52,  1.34it/s]68it [00:54,  1.30it/s]64it [00:52,  1.35it/s]67it [00:53,  1.27it/s]68it [00:54,  1.25it/s]65it [00:52,  1.24it/s]67it [00:53,  1.27it/s]68it [00:53,  1.34it/s]66it [00:52,  1.34it/s]69it [00:54,  1.32it/s]65it [00:53,  1.29it/s]68it [00:53,  1.26it/s]69it [00:54,  1.29it/s]66it [00:53,  1.24it/s]69it [00:54,  1.36it/s]68it [00:54,  1.28it/s]67it [00:53,  1.34it/s]70it [00:55,  1.29it/s]69it [00:54,  1.28it/s]66it [00:54,  1.28it/s]70it [00:55,  1.31it/s]67it [00:54,  1.27it/s]70it [00:54,  1.34it/s]69it [00:55,  1.30it/s]68it [00:54,  1.35it/s]71it [00:56,  1.24it/s]70it [00:55,  1.30it/s]67it [00:54,  1.27it/s]71it [00:56,  1.28it/s]68it [00:55,  1.29it/s]71it [00:55,  1.35it/s]70it [00:56,  1.31it/s]69it [00:55,  1.36it/s]72it [00:57,  1.28it/s]68it [00:55,  1.31it/s]72it [00:57,  1.30it/s]69it [00:55,  1.31it/s]71it [00:56,  1.24it/s]71it [00:56,  1.33it/s]70it [00:55,  1.36it/s]72it [00:56,  1.25it/s]73it [00:57,  1.28it/s]69it [00:56,  1.31it/s]72it [00:57,  1.28it/s]70it [00:56,  1.32it/s]73it [00:57,  1.30it/s]72it [00:57,  1.33it/s]71it [00:56,  1.36it/s]73it [00:57,  1.24it/s]74it [00:58,  1.30it/s]70it [00:57,  1.33it/s]73it [00:57,  1.31it/s]73it [00:58,  1.35it/s]71it [00:57,  1.28it/s]72it [00:57,  1.36it/s]74it [00:59,  1.16it/s]75it [00:59,  1.31it/s]74it [00:58,  1.19it/s]71it [00:57,  1.35it/s]74it [00:58,  1.33it/s]72it [00:58,  1.29it/s]74it [00:59,  1.31it/s]73it [00:58,  1.34it/s]76it [01:00,  1.33it/s]75it [00:59,  1.16it/s]75it [00:59,  1.21it/s]72it [00:58,  1.36it/s]75it [00:59,  1.29it/s]73it [00:58,  1.31it/s]74it [00:58,  1.36it/s]75it [00:59,  1.27it/s]77it [01:00,  1.35it/s]76it [01:00,  1.21it/s]73it [00:59,  1.36it/s]76it [00:59,  1.22it/s]76it [01:00,  1.32it/s]74it [00:59,  1.32it/s]75it [00:59,  1.34it/s]76it [01:00,  1.26it/s]77it [01:01,  1.26it/s]78it [01:01,  1.29it/s]74it [01:00,  1.35it/s]77it [01:00,  1.25it/s]77it [01:00,  1.34it/s]76it [01:00,  1.35it/s]75it [01:00,  1.30it/s]77it [01:01,  1.27it/s]78it [01:02,  1.29it/s]79it [01:02,  1.31it/s]75it [01:00,  1.35it/s]78it [01:01,  1.34it/s]78it [01:01,  1.20it/s]76it [01:01,  1.32it/s]77it [01:01,  1.30it/s]78it [01:02,  1.27it/s]79it [01:02,  1.29it/s]80it [01:03,  1.33it/s]76it [01:01,  1.35it/s]79it [01:02,  1.34it/s]79it [01:02,  1.23it/s]77it [01:01,  1.30it/s]78it [01:01,  1.30it/s]79it [01:03,  1.27it/s]80it [01:03,  1.28it/s]81it [01:03,  1.32it/s]77it [01:02,  1.33it/s]80it [01:02,  1.36it/s]78it [01:02,  1.33it/s]80it [01:03,  1.19it/s]79it [01:02,  1.30it/s]80it [01:03,  1.30it/s]82it [01:04,  1.34it/s]81it [01:04,  1.28it/s]78it [01:03,  1.30it/s]81it [01:03,  1.26it/s]79it [01:03,  1.29it/s]81it [01:04,  1.19it/s]80it [01:03,  1.29it/s]81it [01:04,  1.30it/s]82it [01:05,  1.30it/s]83it [01:05,  1.32it/s]79it [01:03,  1.31it/s]82it [01:04,  1.28it/s]80it [01:04,  1.30it/s]81it [01:04,  1.30it/s]82it [01:04,  1.21it/s]82it [01:05,  1.32it/s]83it [01:05,  1.30it/s]84it [01:06,  1.32it/s]80it [01:04,  1.28it/s]83it [01:05,  1.27it/s]81it [01:04,  1.32it/s]83it [01:05,  1.25it/s]82it [01:05,  1.28it/s]83it [01:06,  1.30it/s]84it [01:06,  1.30it/s]85it [01:07,  1.30it/s]81it [01:05,  1.32it/s]84it [01:06,  1.28it/s]82it [01:05,  1.31it/s]84it [01:06,  1.26it/s]83it [01:05,  1.30it/s]84it [01:06,  1.32it/s]86it [01:07,  1.32it/s]85it [01:07,  1.30it/s]82it [01:06,  1.28it/s]85it [01:06,  1.29it/s]83it [01:06,  1.30it/s]84it [01:06,  1.28it/s]85it [01:07,  1.30it/s]85it [01:07,  1.22it/s]87it [01:08,  1.33it/s]86it [01:08,  1.30it/s]83it [01:06,  1.32it/s]86it [01:07,  1.32it/s]84it [01:07,  1.29it/s]86it [01:08,  1.30it/s]85it [01:07,  1.26it/s]88it [01:09,  1.33it/s]87it [01:09,  1.30it/s]86it [01:08,  1.16it/s]84it [01:07,  1.31it/s]87it [01:08,  1.33it/s]87it [01:09,  1.31it/s]86it [01:08,  1.28it/s]85it [01:08,  1.21it/s]89it [01:10,  1.32it/s]88it [01:09,  1.30it/s]89it [01:10,  1.27it/s]
87it [01:08,  1.22it/s]85it [01:08,  1.31it/s]88it [01:09,  1.29it/s]88it [01:09,  1.34it/s]87it [01:08,  1.31it/s]86it [01:08,  1.25it/s]89it [01:10,  1.31it/s]89it [01:10,  1.26it/s]
86it [01:09,  1.34it/s]88it [01:09,  1.22it/s]89it [01:10,  1.29it/s]89it [01:10,  1.27it/s]
88it [01:09,  1.33it/s]89it [01:10,  1.31it/s]89it [01:10,  1.26it/s]
87it [01:09,  1.23it/s]87it [01:09,  1.35it/s]89it [01:10,  1.27it/s]89it [01:10,  1.26it/s]
89it [01:10,  1.34it/s]89it [01:10,  1.26it/s]
88it [01:10,  1.23it/s]88it [01:10,  1.37it/s]89it [01:11,  1.24it/s]89it [01:11,  1.25it/s]
89it [01:11,  1.32it/s]89it [01:11,  1.25it/s]
Evaluating newsvqa_val ...
Results saved to ./res/news-vqa/newsvqa_val_241224113206.json
avg vtokens tensor(252.0)
avg total tokens 5487.188202247191
python utils/infographicsvqa_eval.py -g /gruntdata/heyuan67/zqp/NewsVQA/ICDAR2023/annotation/swift_newsvideoqa_version_2_val_release2.json -s ./res/news-vqa/newsvqa_val_241224113206.json

Overall ANLS: 0.6872
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
write results to file ./res/news-vqa/models_Qwen__Qwen2-VL-7B-Instruct.txt
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val == vqa-newsvqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v3-top3 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v3-top3-test2 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v3-top5 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v3-top5-test2 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v4-top3_mix ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v4-top3_mix-test2 ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v4-top5_mix ']'
+ '[' vqa-newsvqa-val == vqa-slidevqa-val-unsupervised-cls-v4-top5_mix-test2 ']'
